# -*- coding: utf-8 -*-
# vim: ft=jinja

{## Start with  defaults from defaults.yaml ##}
{% import_yaml "kubernetes/defaults.yaml" as defaults %}
{% set defaults = defaults.kubernetes %}

{% set kubernetes_data = salt['pillar.get']('kubernetes', {
    'lookup': salt['grains.filter_by']({
        'Debian': {
         'system_certs_dir': '/etc/ssl/certs',
        },
        'RedHat': {
         'system_certs_dir': '/etc/ssl/certs',
        },
    }),
    'config': salt['grains.filter_by']({
        'Debian': {
        },
        'RedHat': {
        },
    }),
    'repository': salt['grains.filter_by']({
        'Debian': {
          'name': 'deb http://apt.kubernetes.io/ kubernetes-xenial main',
          'key_url': 'https://packages.cloud.google.com/apt/doc/apt-key.gpg',
        },
        'RedHat': {
        },
    }),
}, merge=True) %}

{## On day - We will have deep merging ##}
{% set kubernetes = salt['defaults.merge'](defaults,kubernetes_data) %}


